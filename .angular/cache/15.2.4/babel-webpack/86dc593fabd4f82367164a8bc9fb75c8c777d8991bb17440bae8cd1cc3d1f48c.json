{"ast":null,"code":"import * as d3 from \"d3v4\";\nimport * as i0 from \"@angular/core\";\nexport class SunburstGraphComponent {\n  ngOnInit() {\n    this.renderSunburstGraph();\n  }\n  renderSunburstGraph() {\n    var rowData = {\n      name: \"Vehicle\",\n      children: [{\n        name: \"Domain1\",\n        children: [{\n          name: \"ecu1\",\n          children: [{\n            name: \"vendor1\",\n            children: [{\n              name: \"ecu-Gen\",\n              children: [{\n                name: \"gen1\",\n                size: 3938\n              }, {\n                name: \"gen2\",\n                size: 3812\n              }, {\n                name: \"gen4\",\n                size: 6714\n              }, {\n                name: \"gen5\",\n                size: 743\n              }]\n            }]\n          }]\n        }, {\n          name: \"ecu2\",\n          children: [{\n            name: \"vendor2\",\n            children: [{\n              name: \"ecu-Gen\",\n              children: [{\n                name: \"s1\",\n                size: 3938\n              }, {\n                name: \"s2\",\n                size: 3812\n              }, {\n                name: \"s3\",\n                size: 6714\n              }, {\n                name: \"s4\",\n                size: 743\n              }]\n            }]\n          }]\n        }, {\n          name: \"ecu3\",\n          children: [{\n            name: \"vendor3\",\n            children: [{\n              name: \"ecu-Gen3\",\n              children: [{\n                name: \"s3-1\",\n                size: 3938\n              }, {\n                name: \"s3-2\",\n                size: 3812\n              }, {\n                name: \"s3-3\",\n                size: 6714\n              }, {\n                name: \"s3-4\",\n                size: 743\n              }]\n            }]\n          }]\n        }]\n      }, {\n        name: \"Domain2\",\n        children: [{\n          name: \"ecu-2\",\n          children: [{\n            name: \"ecu-Gen2\",\n            children: [{\n              name: \"s21\",\n              size: 3938\n            }, {\n              name: \"sg2\",\n              size: 3812\n            }, {\n              name: \"sg3\",\n              size: 6714\n            }, {\n              name: \"sg4\",\n              size: 743\n            }]\n          }]\n        }]\n      }, {\n        name: \"Domain3\",\n        children: [{\n          name: \"ecu-3\",\n          children: [{\n            name: \"ecu-Gen3\",\n            children: [{\n              name: \"s21-3\",\n              size: 3938\n            }, {\n              name: \"sg2-3\",\n              size: 3812\n            }, {\n              name: \"sg3-3\",\n              size: 6714\n            }, {\n              name: \"sg4-3\",\n              size: 743\n            }]\n          }]\n        }]\n      }]\n    };\n    let path;\n    let text;\n    let center;\n    var width = 1200,\n      height = 1000,\n      radius = Math.min(width, height) / 2;\n    var x = d3.scaleLinear().range([0, 2 * Math.PI]);\n    var y = d3.scaleLinear().range([0, radius]);\n    const color = d3.scaleOrdinal(d3.quantize(d3.interpolateRainbow, rowData.children.length + 1));\n    var partition = d3.partition();\n    var tooltip = d3.select(\"#sunburst\").append(\"div\").classed(\"tooltip\", true);\n    tooltip.append(\"div\").attr(\"class\", \"label\");\n    tooltip.append(\"div\").attr(\"class\", \"count\");\n    tooltip.append(\"div\").attr(\"class\", \"percent\");\n    var svg = d3.select(\"#sunburst\").append(\"svg\").attr(\"width\", width).attr(\"height\", height).attr(\"viewBox\", [0, 0, width, width]).style(\"font\", \"16px sans-serif\").style(\"cursor\", \"pointer\").append(\"g\").attr(\"transform\", \"translate(\" + width / 2 + \",\" + height / 2 + \")\");\n    var arc = d3.arc().startAngle(function (d) {\n      return Math.max(0, Math.min(2 * Math.PI, x(d.x0)));\n    }).endAngle(function (d) {\n      return Math.max(0, Math.min(2 * Math.PI, x(d.x1)));\n    }).innerRadius(function (d) {\n      return Math.max(0, y(d.y0));\n    }).outerRadius(function (d) {\n      return Math.max(0, y(d.y1));\n    });\n    d3.json(\n    // import the row json data here\n    \"data:text/json;charset=utf-8,\" + JSON.stringify(rowData), function (error, root) {\n      if (error) throw error;\n      root = d3.hierarchy(root);\n      root.sum(function (d) {\n        return d.size;\n      });\n      svg.selectAll(\"path\").data(partition(root).descendants()).enter().append(\"g\").attr(\"class\", \"node\");\n      path = svg.selectAll(\".node\").append(\"path\").attr(\"d\", arc)\n      // .style('fill', function (d) {\n      //   return color(d.depth);\n      // })\n      .attr(\"fill\", d => {\n        while (d.depth > 1) d = d.parent;\n        return color(d.data.name);\n      })\n      // .style(\"stroke\", \"#000000\")\n      // .style(\"stroke\", \"none\")\n      .on(\"click\", clickHandler).on(\"mouseover\", mouseOverHandler).on(\"mouseout\", mouseOutHandler).on(\"mousemove\", mouseMoveHandler);\n      text = svg.selectAll(\".node\").append(\"text\").attr(\"transform\", function (d) {\n        return \"rotate(\" + computeTextRotation(d) + \")\";\n      }).attr(\"x\", function (d) {\n        return y(d.y0);\n      }).attr(\"dx\", \"6\").attr(\"dy\", \".35em\").text(function (d) {\n        return d.data.name;\n      }).on(\"click\", clickHandler).on(\"mouseover\", mouseOverHandler).on(\"mouseout\", mouseOutHandler).on(\"mousemove\", mouseMoveHandler);\n    });\n    function clickHandler(d) {\n      //Hide text while Sunburst transitions\n      text.transition().attr(\"opacity\", 0);\n      svg.transition().duration(750).tween(\"scale\", function () {\n        var xd = d3.interpolate(x.domain(), [d.x0, d.x1]),\n          yd = d3.interpolate(y.domain(), [d.y0, 1]),\n          yr = d3.interpolate(y.range(), [d.y0 ? 20 : 0, radius]);\n        return function (t) {\n          x.domain(xd(t));\n          y.domain(yd(t)).range(yr(t));\n        };\n      }).selectAll(\"path\").attrTween(\"d\", function (d) {\n        return function () {\n          return arc(d);\n        };\n      }).on(\"end\", function (e, i) {\n        // Check if the animated element's data e lies within the visible\n        // angle span given in d:\n        if (e.x0 >= d.x0 && e.x0 < d.x1) {\n          // get a selection of the associated text element\n          var arcText = d3.select(this.parentNode).select(\"text\");\n          // fade in the text element and recalculate positions\n          arcText.transition().duration(750).attr(\"opacity\", 1).attr(\"transform\", function () {\n            return \"rotate(\" + computeTextRotation(e) + \")\";\n          }).attr(\"x\", function (d) {\n            return y(d.y0);\n          }).text(function (d) {\n            return d.data.name === \"root\" ? \"\" : d.data.name;\n          });\n        }\n      });\n    }\n    function mouseOverHandler(d) {\n      var total = d?.parent?.value;\n      var percent = Math.round(1000 * d.value / total) / 10; // calculate percent\n      tooltip.select(\".label\").html(d.data.name); // set current label\n      tooltip.select(\".count\").html(d.value); // set current count\n      tooltip.select(\".percent\").html(percent + \"%\"); // set percent calculated above\n      tooltip.style(\"display\", \"block\"); // set display\n    }\n\n    function mouseOutHandler() {\n      // when mouse leaves div\n      tooltip.style(\"display\", \"none\"); // hide tooltip for that element\n    }\n\n    function mouseMoveHandler(d) {\n      // when mouse moves\n      tooltip.style(\"top\", d3.event.layerY + 10 + \"px\"); // always 10px below the cursor\n      tooltip.style(\"left\", d3.event.layerX + 10 + \"px\"); // always 10px to the right of the mouse\n    }\n\n    function computeTextRotation(d) {\n      var angle = (x((d.x0 + d.x1) / 2) - Math.PI / 2) / Math.PI * 180;\n      return angle > 90 || angle < 270 ? angle : 180 + angle;\n    }\n  }\n}\nSunburstGraphComponent.ɵfac = function SunburstGraphComponent_Factory(t) {\n  return new (t || SunburstGraphComponent)();\n};\nSunburstGraphComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: SunburstGraphComponent,\n  selectors: [[\"app-sunburst-graph\"]],\n  decls: 1,\n  vars: 0,\n  consts: [[\"id\", \"sunburst\", 2, \"text-align\", \"center\"]],\n  template: function SunburstGraphComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"div\", 0);\n    }\n  },\n  styles: [\"div.tooltip[_ngcontent-%COMP%] {\\n  position: absolute;\\n  width: 200px;\\n  height: auto;\\n  padding: 10px;\\n  display: none;\\n  background-color: white;\\n  border-radius: 10px;\\n  box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\\n  pointer-events: none;\\n}\\n\\ndiv.tooltip[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {\\n  margin: 0;\\n  font-family: Arial;\\n  font-size: 16px;\\n  line-height: 20px;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvc3VuYnVyc3QtZ3JhcGgvc3VuYnVyc3QtZ3JhcGguY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGtCQUFrQjtFQUNsQixZQUFZO0VBQ1osWUFBWTtFQUNaLGFBQWE7RUFDYixhQUFhO0VBQ2IsdUJBQXVCO0VBR3ZCLG1CQUFtQjtFQUduQiwyQ0FBMkM7RUFDM0Msb0JBQW9CO0FBQ3RCOztBQUVBO0VBQ0UsU0FBUztFQUNULGtCQUFrQjtFQUNsQixlQUFlO0VBQ2YsaUJBQWlCO0FBQ25CIiwic291cmNlc0NvbnRlbnQiOlsiZGl2LnRvb2x0aXAge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHdpZHRoOiAyMDBweDtcbiAgaGVpZ2h0OiBhdXRvO1xuICBwYWRkaW5nOiAxMHB4O1xuICBkaXNwbGF5OiBub25lO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcbiAgLXdlYmtpdC1ib3JkZXItcmFkaXVzOiAxMHB4O1xuICAtbW96LWJvcmRlci1yYWRpdXM6IDEwcHg7XG4gIGJvcmRlci1yYWRpdXM6IDEwcHg7XG4gIC13ZWJraXQtYm94LXNoYWRvdzogNHB4IDRweCAxMHB4IHJnYmEoMCwgMCwgMCwgMC40KTtcbiAgLW1vei1ib3gtc2hhZG93OiA0cHggNHB4IDEwcHggcmdiYSgwLCAwLCAwLCAwLjQpO1xuICBib3gtc2hhZG93OiA0cHggNHB4IDEwcHggcmdiYSgwLCAwLCAwLCAwLjQpO1xuICBwb2ludGVyLWV2ZW50czogbm9uZTtcbn1cblxuZGl2LnRvb2x0aXAgcCB7XG4gIG1hcmdpbjogMDtcbiAgZm9udC1mYW1pbHk6IEFyaWFsO1xuICBmb250LXNpemU6IDE2cHg7XG4gIGxpbmUtaGVpZ2h0OiAyMHB4O1xufVxuIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["d3","SunburstGraphComponent","ngOnInit","renderSunburstGraph","rowData","name","children","size","path","text","center","width","height","radius","Math","min","x","scaleLinear","range","PI","y","color","scaleOrdinal","quantize","interpolateRainbow","length","partition","tooltip","select","append","classed","attr","svg","style","arc","startAngle","d","max","x0","endAngle","x1","innerRadius","y0","outerRadius","y1","json","JSON","stringify","error","root","hierarchy","sum","selectAll","data","descendants","enter","depth","parent","on","clickHandler","mouseOverHandler","mouseOutHandler","mouseMoveHandler","computeTextRotation","transition","duration","tween","xd","interpolate","domain","yd","yr","t","attrTween","e","i","arcText","parentNode","total","value","percent","round","html","event","layerY","layerX","angle","selectors","decls","vars","consts","template","i0"],"sourceRoot":"","sources":["/home/chromosome/Documents/UST/angular-sunburst-d3/src/app/sunburst-graph/sunburst-graph.component.ts","/home/chromosome/Documents/UST/angular-sunburst-d3/src/app/sunburst-graph/sunburst-graph.component.html"],"sourcesContent":["import { Component, OnInit } from \"@angular/core\";\nimport * as d3 from \"d3v4\";\n@Component({\n  selector: \"app-sunburst-graph\",\n  templateUrl: \"./sunburst-graph.component.html\",\n  styleUrls: [\"./sunburst-graph.component.css\"],\n})\nexport class SunburstGraphComponent implements OnInit {\n  ngOnInit(): void {\n    this.renderSunburstGraph();\n  }\n\n  renderSunburstGraph() {\n    var rowData = {\n      name: \"Vehicle\",\n      children: [\n        {\n          name: \"Domain1\",\n          children: [\n            {\n              name: \"ecu1\",\n              children: [\n                {\n                  name: \"vendor1\",\n                  children: [\n                    {\n                      name: \"ecu-Gen\",\n                      children: [\n                        {\n                          name: \"gen1\",\n                          size: 3938,\n                        },\n                        {\n                          name: \"gen2\",\n                          size: 3812,\n                        },\n                        {\n                          name: \"gen4\",\n                          size: 6714,\n                        },\n                        {\n                          name: \"gen5\",\n                          size: 743,\n                        },\n                      ],\n                    },\n                  ],\n                },\n              ],\n            },\n            {\n              name: \"ecu2\",\n              children: [\n                {\n                  name: \"vendor2\",\n                  children: [\n                    {\n                      name: \"ecu-Gen\",\n                      children: [\n                        {\n                          name: \"s1\",\n                          size: 3938,\n                        },\n                        {\n                          name: \"s2\",\n                          size: 3812,\n                        },\n                        {\n                          name: \"s3\",\n                          size: 6714,\n                        },\n                        {\n                          name: \"s4\",\n                          size: 743,\n                        },\n                      ],\n                    },\n                  ],\n                },\n              ],\n            },\n            {\n              name: \"ecu3\",\n              children: [\n                {\n                  name: \"vendor3\",\n                  children: [\n                    {\n                      name: \"ecu-Gen3\",\n                      children: [\n                        {\n                          name: \"s3-1\",\n                          size: 3938,\n                        },\n                        {\n                          name: \"s3-2\",\n                          size: 3812,\n                        },\n                        {\n                          name: \"s3-3\",\n                          size: 6714,\n                        },\n                        {\n                          name: \"s3-4\",\n                          size: 743,\n                        },\n                      ],\n                    },\n                  ],\n                },\n              ],\n            },\n          ],\n        },\n        {\n          name: \"Domain2\",\n          children: [\n            {\n              name: \"ecu-2\",\n              children: [\n                {\n                  name: \"ecu-Gen2\",\n\n                  children: [\n                    {\n                      name: \"s21\",\n                      size: 3938,\n                    },\n                    {\n                      name: \"sg2\",\n                      size: 3812,\n                    },\n                    {\n                      name: \"sg3\",\n                      size: 6714,\n                    },\n                    {\n                      name: \"sg4\",\n                      size: 743,\n                    },\n                  ],\n                },\n              ],\n            },\n          ],\n        },\n        {\n          name: \"Domain3\",\n          children: [\n            {\n              name: \"ecu-3\",\n              children: [\n                {\n                  name: \"ecu-Gen3\",\n\n                  children: [\n                    {\n                      name: \"s21-3\",\n                      size: 3938,\n                    },\n                    {\n                      name: \"sg2-3\",\n                      size: 3812,\n                    },\n                    {\n                      name: \"sg3-3\",\n                      size: 6714,\n                    },\n                    {\n                      name: \"sg4-3\",\n                      size: 743,\n                    },\n                  ],\n                },\n              ],\n            },\n          ],\n        },\n      ],\n    };\n\n    let path: any;\n    let text: any;\n    let center: any;\n    var width = 1200,\n      height = 1000,\n      radius = Math.min(width, height) / 2;\n\n    var x = d3.scaleLinear().range([0, 2 * Math.PI]);\n\n    var y = d3.scaleLinear().range([0, radius]);\n\n    const color = d3.scaleOrdinal(\n      d3.quantize(d3.interpolateRainbow, rowData.children.length + 1)\n    );\n\n    var partition = d3.partition();\n\n    var tooltip = d3.select(\"#sunburst\").append(\"div\").classed(\"tooltip\", true);\n    tooltip.append(\"div\").attr(\"class\", \"label\");\n    tooltip.append(\"div\").attr(\"class\", \"count\");\n    tooltip.append(\"div\").attr(\"class\", \"percent\");\n\n    var svg = d3\n      .select(\"#sunburst\")\n      .append(\"svg\")\n      .attr(\"width\", width)\n      .attr(\"height\", height)\n      .attr(\"viewBox\", [0, 0, width, width])\n      .style(\"font\", \"16px sans-serif\")\n      .style(\"cursor\", \"pointer\")\n      .append(\"g\")\n      .attr(\"transform\", \"translate(\" + width / 2 + \",\" + height / 2 + \")\");\n\n    var arc = d3\n      .arc()\n      .startAngle(function (d) {\n        return Math.max(0, Math.min(2 * Math.PI, x(d.x0)));\n      })\n      .endAngle(function (d) {\n        return Math.max(0, Math.min(2 * Math.PI, x(d.x1)));\n      })\n      .innerRadius(function (d) {\n        return Math.max(0, y(d.y0));\n      })\n      .outerRadius(function (d) {\n        return Math.max(0, y(d.y1));\n      });\n\n    d3.json(\n      // import the row json data here\n      \"data:text/json;charset=utf-8,\" + JSON.stringify(rowData),\n      function (error, root) {\n        if (error) throw error;\n\n        root = d3.hierarchy(root);\n        root.sum(function (d) {\n          return d.size;\n        });\n\n        svg\n          .selectAll(\"path\")\n          .data(partition(root).descendants())\n          .enter()\n          .append(\"g\")\n          .attr(\"class\", \"node\");\n\n        path = svg\n          .selectAll(\".node\")\n          .append(\"path\")\n          .attr(\"d\", arc)\n          // .style('fill', function (d) {\n          //   return color(d.depth);\n          // })\n          .attr(\"fill\", (d) => {\n            while (d.depth > 1) d = d.parent;\n            return color(d.data.name);\n          })\n          // .style(\"stroke\", \"#000000\")\n          // .style(\"stroke\", \"none\")\n          .on(\"click\", clickHandler)\n          .on(\"mouseover\", mouseOverHandler)\n          .on(\"mouseout\", mouseOutHandler)\n          .on(\"mousemove\", mouseMoveHandler);\n\n        text = svg\n          .selectAll(\".node\")\n          .append(\"text\")\n          .attr(\"transform\", function (d) {\n            return \"rotate(\" + computeTextRotation(d) + \")\";\n          })\n          .attr(\"x\", function (d) {\n            return y(d.y0);\n          })\n          .attr(\"dx\", \"6\")\n          .attr(\"dy\", \".35em\")\n          .text(function (d) {\n            return d.data.name;\n          })\n          .on(\"click\", clickHandler)\n          .on(\"mouseover\", mouseOverHandler)\n          .on(\"mouseout\", mouseOutHandler)\n          .on(\"mousemove\", mouseMoveHandler);\n      }\n    );\n\n    function clickHandler(d) {\n      //Hide text while Sunburst transitions\n      text.transition().attr(\"opacity\", 0);\n\n      svg\n        .transition()\n        .duration(750)\n        .tween(\"scale\", function () {\n          var xd = d3.interpolate(x.domain(), [d.x0, d.x1]),\n            yd = d3.interpolate(y.domain(), [d.y0, 1]),\n            yr = d3.interpolate(y.range(), [d.y0 ? 20 : 0, radius]);\n          return function (t) {\n            x.domain(xd(t));\n            y.domain(yd(t)).range(yr(t));\n          };\n        })\n        .selectAll(\"path\")\n        .attrTween(\"d\", function (d) {\n          return function () {\n            return arc(d);\n          };\n        })\n        .on(\"end\", function (e, i) {\n          // Check if the animated element's data e lies within the visible\n          // angle span given in d:\n          if (e.x0 >= d.x0 && e.x0 < d.x1) {\n            // get a selection of the associated text element\n            var arcText = d3.select(this.parentNode).select(\"text\");\n            // fade in the text element and recalculate positions\n            arcText\n              .transition()\n              .duration(750)\n              .attr(\"opacity\", 1)\n              .attr(\"transform\", function () {\n                return \"rotate(\" + computeTextRotation(e) + \")\";\n              })\n              .attr(\"x\", function (d) {\n                return y(d.y0);\n              })\n              .text(function (d) {\n                return d.data.name === \"root\" ? \"\" : d.data.name;\n              });\n          }\n        });\n    }\n\n    function mouseOverHandler(d) {\n      var total = d?.parent?.value;\n      var percent = Math.round((1000 * d.value) / total) / 10; // calculate percent\n      tooltip.select(\".label\").html(d.data.name); // set current label\n      tooltip.select(\".count\").html(d.value); // set current count\n      tooltip.select(\".percent\").html(percent + \"%\"); // set percent calculated above\n      tooltip.style(\"display\", \"block\"); // set display\n    }\n    function mouseOutHandler() {\n      // when mouse leaves div\n      tooltip.style(\"display\", \"none\"); // hide tooltip for that element\n    }\n    function mouseMoveHandler(d) {\n      // when mouse moves\n      tooltip.style(\"top\", d3.event.layerY + 10 + \"px\"); // always 10px below the cursor\n      tooltip.style(\"left\", d3.event.layerX + 10 + \"px\"); // always 10px to the right of the mouse\n    }\n    function computeTextRotation(d) {\n      var angle = ((x((d.x0 + d.x1) / 2) - Math.PI / 2) / Math.PI) * 180;\n      return angle > 90 || angle < 270 ? angle : 180 + angle;\n    }\n  }\n}\n","<div id=\"sunburst\" style=\"text-align: center\"></div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}